name: Tests

on: [push]

jobs:
  run-tests:
    runs-on: ubuntu-18.04
    steps:
    - name: Install Python
      uses: actions/setup-python@v2
      with:
        python-version: '3.x'
        architecture: 'x64'

    - name: Install Dependencies
      run: |
        python -m pip install -U pip
        pip install -U pytest selenium flake8 pylint

    - name: Check out and download repository
      uses: actions/checkout@v2

    - name: Check code
      run: |
        flake8 --exit-zero test.py
        pylint --errors-only test.py

    - name: Start Selenoid
      run: |
        wget --no-check-certificate -O cm https://github.com/aerokube/cm/releases/latest/download/cm_linux_amd64
        chmod +x cm
        ./cm selenoid start
        curl http://localhost:4444/status

    - name: Run tests
      run: |
        pytest test.py
